<div *ngIf="isVisible" class="tickets-modal__block">
  <div class="tickets-modal__content">
    <button class="arrow-left__button" (click)="closeModal()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M15 19.92L8.48 13.4C7.71 12.63 7.71 11.37 8.48 10.6L15 4.08" stroke="#1D2935" stroke-width="1.5"
              stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>

    <div class="directions-title__block">
      <div class="directions-info__title">
        <span class="directions-title">{{ fromCity }}</span>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M4 12H20M20 12L14 6M20 12L14 18" stroke="#00B06C" stroke-width="1.5" stroke-linecap="round"
                stroke-linejoin="round"/>
        </svg>
        <span class="directions-title">{{ toCity }}</span>
      </div>
      <div class="booking-info__title" (click)="openBookingInfoModal()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z"
                stroke="#656565" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 8V13" stroke="#656565" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M11.9945 16H12.0035" stroke="#656565" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round"/>
        </svg>
        <span>Цена билетов может меняться</span>
      </div>

      <div class="booking-info__title-passengers">
        <span> {{ selectedDateText }}</span>
        <span>{{ passengerCount }} {{ passengerCount === 1 ? 'пассажир' : 'пассажира' }},</span>
        <span>{{ travelClassText }}</span>
      </div>

      <div class="filters-block">
        <button (click)="openPriceFilter()">
          Цена
          <svg width="16" height="16" viewBox="0 0 18 18" fill="none">
            <path d="M14.9401 6.74999L10.0501 11.64C9.47256 12.2175 8.52756 12.2175 7.95006 11.64L3.06006 6.74999"
                  stroke="#1D2935" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                  stroke-linejoin="round"/>
          </svg>
        </button>
        <button (click)="openTransferFilter()">
          Пересадки
          <svg width="16" height="16" viewBox="0 0 18 18" fill="none">
            <path d="M14.9401 6.74999L10.0501 11.64C9.47256 12.2175 8.52756 12.2175 7.95006 11.64L3.06006 6.74999"
                  stroke="#1D2935" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                  stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>

    <div class="loader-block" *ngIf="isLoading">
      <div class="loader"></div>
    </div>

    <ul class="tickets-list" *ngIf="!isLoading">
      <li
        class="tickets-list__item"
        *ngFor="let flight of flights | keyvalue"
      >
        <div (click)="selectFlight(flight)">
          <div class="tickets-list__item-top">
            <img
              ngSrc="assets/suppliers/{{ flight.value.validating_supplier }}.png"
              alt=""
              height="30"
              width="90"
            >

            <div class="amount-money__block">
              <span class="amount-title">{{ flight.value.total_price.TJS }} TJS</span>
              <small>В одну сторону</small>
            </div>
          </div>

          <div>
            <div class="airplane-icon__block">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path
                  d="M4.07033 13.3827L4.93044 11.5441C5.06323 11.267 4.96316 10.8935 4.70958 10.7199L3.0454 9.55766C2.77836 9.25652 2.83835 8.78492 3.17733 8.55605L3.95786 8.04323C4.14495 7.91718 4.46659 7.90692 4.66255 8.02006L6.52243 9.08842C6.6548 9.17028 6.88329 9.19878 7.0314 9.1591L8.86666 8.66734C9.13712 8.59487 9.21242 8.36074 9.04209 8.1372L6.82972 5.3412C6.48435 4.9023 6.63967 4.42587 7.18059 4.28093L8.01128 4.05835C8.44273 3.94274 9.02485 4.13186 9.29925 4.48624L11.8157 7.67009C11.8884 7.76104 12.0478 7.81496 12.1637 7.7839L14.0955 7.26627C14.7009 7.10407 15.5347 7.35687 15.9565 7.8236C16.1049 7.9909 16.1653 8.21628 16.1204 8.43535C15.9885 9.05046 15.3863 9.68804 14.781 9.85023L12.8492 10.3679C12.7332 10.3989 12.6222 10.5253 12.6047 10.6404L12.0156 14.6495C11.9616 15.0919 11.552 15.5467 11.1206 15.6623L10.2899 15.8849C9.74895 16.0299 9.37623 15.6949 9.45587 15.1421L9.97384 11.6145C10.0177 11.3405 9.8273 11.1707 9.55684 11.2431L7.72158 11.7349C7.57348 11.7746 7.38984 11.9135 7.31442 12.0442L6.23789 13.8993C6.12475 14.0953 5.84752 14.2455 5.61603 14.2316L4.68366 14.1777C4.27911 14.1619 3.98492 13.7852 4.07033 13.3827Z"
                  stroke="#00B06C" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>

            <div class="times-block">
              <span
                class="times-block__item">{{ extractHours(flight.value.routes[0].segments[0].departure.time) }}</span>
              <span class="times-block__title">{{ convertDuration(flight.value.routes[0].duration) }}</span>
              <span class="times-block__item">{{ extractHours(flight.value.routes[0].segments[0].arrival.time) }}</span>
            </div>
          </div>

          <div class="divider"></div>

          <div class="tickets-list__item-bottom">
            <span>{{ flight.value.routes[0].segments[0].departure.airport }}</span>

            <span>
            <ng-container *ngIf="flight.value.routes[0].segments.length === 1; else transfer">
              Прямой
            </ng-container>
            <ng-template #transfer>
              {{ flight.value.routes[0].segments.length - 1 }} пересадка(и)
            </ng-template>
          </span>

            <span>{{ flight.value.routes[0].segments[flight.value.routes[0].segments.length - 1].arrival.airport }}</span>
          </div>
        </div>
      </li>
    </ul>

    <div *ngIf="!isLoading && flights.length === 0">
      <p>Билеты не найдены</p>
    </div>

    <!-- Booking info modal -->
    <div class="booking-info__modal-layout" *ngIf="isBookingInfoModal">
      <div class="booking-info__modal">
        <h1>Цена билетов может меняться</h1>
        <span>Почему?</span>
        <p>Пока вы ищите свою карту или паспорт, цена может обновиться.</p>
        <p>Заполните данные и оплатите авиабилет в течение 10 минут, чтобы цена не изменилась.</p>

        <button class="btn-primary" (click)="closeBookingInfoModal()">Понятно</button>
      </div>
    </div>

    <!-- Price filter modal -->
    <div class="price-filter__modal-layout" *ngIf="isPriceFilter">
      <div class="price-filter__modal">
        <div class="holder-button">
          <svg width="35" height="4" viewBox="0 0 35 4" fill="none">
            <rect width="35" height="4" rx="2" fill="#95A5A6" fill-opacity="0.5"/>
          </svg>
        </div>

        <h1>Цена</h1>

        <ul>
          <li>Сначало дешёвые</li>
          <li>Сначало дорогие</li>
        </ul>
      </div>
    </div>

    <!-- Transfer filter modal -->
    <div class="transfer-filter__modal-layout" *ngIf="isTransferFilter">
      <div class="transfer-filter__modal">
        <div class="holder-button">
          <svg width="35" height="4" viewBox="0 0 35 4" fill="none">
            <rect width="35" height="4" rx="2" fill="#95A5A6" fill-opacity="0.5"/>
          </svg>
        </div>
        <h1>Пересадки</h1>

        <ul>
          <li>Прямой</li>
          <li>1 пересадка</li>
          <li>2 пересдки и более</li>
        </ul>
      </div>
    </div>
  </div>
</div>
